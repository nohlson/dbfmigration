# dbfmigration
DBF to JSON Migration Tool

Inventory.json: ARINVT01
"All parts in inventory"
CustomerInfo.json: ARCUST01
"Customer information like address"
SupplierInfo.json: APVEND01
"Supplier/vendor information like address"
CustomerShipping.json: SOADDR01
"Connects customer numbers to the shipping addresses in sales orders"
SalesOrderParts.json: SOYTRN01
"Individual records for a part in a sales order, price etc"


For Convert.py:
Create a directory called `json` at top level, include `Inventory.json`, `CustomerInfo.json`, `SupplierInfo.json`, and `CustomerShipping.json`. These will be command line arguments
for `Convert.py`



Backing up mongodb docker container

```
docker exec acus-mongodb mongodump --db migrationtest --archive --gzip > backups/migrationtest_$(date +%F_%H-%M).gz
```


Restore from backup

```
cat backups/migrationtest_2025-05-07_16-00.gz | docker exec -i acus-mongodb mongorestore --archive --gzip --nsInclude="migrationtest.*" --drop
```

Run simple updater. It overwrites quantity and notes and location in parts. Location comes from SEQ, and notes are VPARTNO + additional notes

```
python3 UpdatePartNotesQuantities.py --mongo-hostname localhost --database-name migrationtest --parts-file json/InventoryNew.json  --parts-notes-file json/InventoryNotes.json --dry-run
```


Using SalesOrderHistoryMigrator.py:
```
python3 SalesOrderHistoryMigrator.py \           
  --mongo-hostname localhost \
  --mongo-port 27017 \
  --database-name acusprod \
  --sales-file  json/SalesOrderParts.json  --sales-person-id 67920d24cb35698e16a230f0 \ 
  --account-type UPS \
  --account-number 5094X3 \
  --terms "Net 30" \
  --batch-size 500
```


FixItemNumberDotZero.py
In older versions of the conversion script Inventory items that were just numeric would strip preceeding 0 characters and add ".0" to the end. This script will look at the old version of the JSON
generated by the incorrect script and the new script that accurately parses the item numbers and make the adjustements necessary in mongodb.
```
python3 FixItemNumberDotZero.py \
  --old-file json/Inventory.json \
  --new-file json/InventoryNew.json \
  --mongo-hostname localhost \
  --mongo-port 27017 \
  --database-name acusprod \
  --batch-size 500
  ```